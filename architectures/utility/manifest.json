{
  "design": {
    "sales": {
      "name": "Sales",
      "services": [
        { "name": "Utility Ecommerce Form", "type": "frontend" },
        { "name": "Utility Ecommerce BFF", "type": "bff" }
      ]
    },
    "integrations": {
      "name": "Integrations",
      "services": [
        { "name": "Event Log", "type": "event-bus" },
        {
          "name": "Event Log to CRM Worker",
          "type": "integration",
          "integrates": ["sales", "customer_care"]
        }
      ]
    },
    "customer_care": {
      "name": "Customer Care",
      "services": [
        { "name": "CRM Database", "type": "database" },
        { "name": "Utility CRM Dashboard", "type": "frontend" },
        { "name": "Utility CRM Dashboard BFF", "type": "bff" }
      ]
    },
    "billing": {
      "name": "Billing",
      "services": [
        { "name": "Billing Database", "type": "database" },
        { "name": "Utility Billing Dashboard", "type": "frontend" },
        { "name": "Utility Billing BFF", "type": "bff" }
      ]
    }
  },
  "phases": [
    {
      "phase": "boot-infra",
      "pieces": [
        { "module": "./modules/event-log", "port": 4400 },
        { "module": "./modules/mysql-simulator", "port": 4500, "options": { "mysqlPort": 3307 } },
        {
          "module": "./modules/dashboard",
          "port": 4300,
          "options": {
            "widgets": {
              "architecture": [
                {
                  "id": "utility-ecommerce",
                  "title": "Utility Ecommerce",
                  "url": "http://localhost:5800/microfront/ecommerce-form.js",
                  "tagName": "utility-ecommerce-form",
                  "props": {
                    "bff-url": "http://localhost:5800/api/orders"
                  }
                },
                {
                  "id": "utility-event-log",
                  "title": "Eventos ecommerce",
                  "url": "http://localhost:4400/microfrontends/event-log-monitor.js",
                  "tagName": "event-log-monitor",
                  "props": {
                    "metrics-url": "http://localhost:4400/metrics"
                  }
                },
                {
                  "id": "utility-crm-dashboard",
                  "title": "Clientes y contratos CRM",
                  "url": "http://localhost:5900/microfront/crm-dashboard.js",
                  "tagName": "utility-crm-dashboard",
                  "props": {
                    "api-base-url": "http://localhost:5900",
                    "page-size": 5
                  }
                },
                {
                  "id": "utility-billing-dashboard",
                  "title": "Facturaci√≥n CRM",
                  "url": "http://localhost:6000/microfront/billing-dashboard.js",
                  "tagName": "utility-billing-dashboard",
                  "props": {
                    "api-base-url": "http://localhost:6000",
                    "page-size": 5
                  }
                }
              ]
            }
          }
        }
      ]
    },
    {
      "phase": "initialize",
      "pieces": [
        {
          "module": "./architectures/utility/init/initialize.js",
          "options": {
            "mysql": {
              "schema": "./architectures/utility/init/mysql/crm-schema.sql",
              "host": "localhost",
              "port": 3307,
              "user": "root",
              "password": ""
            }
          }
        }
      ]
    },
    {
      "phase": "start-middleware",
      "pieces": [
        {
          "module": "./architectures/utility/infra/middleware/event-log-to-crm.js",
          "options": {
            "pollIntervalMs": 4000,
            "eventLog": {
              "endpoint": "http://localhost:4400",
              "queueName": "ecommerce",
              "publishQueues": {
                "customerQueue": "crm-clients",
                "contractQueue": "crm-contracts"
              }
            },
            "mysql": {
              "host": "localhost",
              "port": 3307,
              "user": "root",
              "password": "",
              "database": "crm"
            }
          }
        }
      ]
    },
    {
      "phase": "start-services",
      "pieces": [
        {
          "module": "./architectures/utility/services/ecommerce/bff/index.js",
          "port": 5800,
          "options": {
            "eventLogUrl": "http://localhost:4400/event-log/queues/ecommerce/events",
            "microfrontPath": "./architectures/utility/services/ecommerce/microfront/EcommerceForm.microfrontend"
          }
        },
        {
          "module": "./architectures/utility/services/crm-dashboard/bff/index.js",
          "port": 5900,
          "options": {
            "mysql": {
              "host": "localhost",
              "port": 3307,
              "user": "root",
              "password": "",
              "database": "crm"
            },
            "microfrontPath": "./architectures/utility/services/crm-dashboard/microfront/CrmDashboard.microfrontend",
            "pageSize": 5,
            "maxPageSize": 25
          }
        },
        {
          "module": "./architectures/utility/services/billing-dashboard/bff/index.js",
          "port": 6000,
          "options": {
            "mysql": {
              "host": "localhost",
              "port": 3307,
              "user": "root",
              "password": "",
              "database": "billing"
            },
            "microfrontPath": "./architectures/utility/services/billing-dashboard/microfront/BillingDashboard.microfrontend",
            "pageSize": 5,
            "maxPageSize": 25,
            "eventLog": {
              "endpoint": "http://localhost:4400",
              "customerQueue": "crm-clients",
              "contractQueue": "crm-contracts",
              "pollIntervalMs": 4000
            }
          }
        }
      ]
    }
  ]
}
